<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>Grammar Exercise: Life vs. Live</title>
  <style>
    :root {
      /* For easy scaling/tweaking */
      --base-font-size: 16px;
      --container-max-width: 900px;
    }
    html {
      font-size: var(--base-font-size);
      /* For scaling in iframes/embedded environments */
      width: 100%;
      height: 100%;
    }
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2vw;
      color: #333;
      width: 100vw;
      height: 100vh;
      box-sizing: border-box;
      /* Prevent overflow in embeds */
      overflow: auto;
    }
    .container {
      background-color: #ffffff;
      border-radius: 1.125em;
      box-shadow: 0 0.625em 1.875em rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: var(--container-max-width);
      min-width: 220px;
      overflow: hidden;
      animation: fadeIn 0.5s ease-in-out;
      /* Responsive for embedded iframes */
      box-sizing: border-box;
      font-size: 1rem;
    }
    header {
      background: linear-gradient(90deg, #8E2DE2 0%, #4A00E0 100%);
      color: white;
      padding: 1.625em 1.75em;
      text-align: center;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 0.5em;
      font-weight: 700;
      letter-spacing: 0.013em;
    }
    header p {
      opacity: 0.95;
      font-size: 1.125em;
    }
    .instructions {
      background-color: #f8f4ff;
      padding: 1.125em 1.375em;
      border-bottom: 1px solid #e8e0f5;
      font-size: 1em;
      color: #666;
    }
    .pronunciation-guide {
      background-color: #f0e8ff;
      padding: 0.938em;
      margin: 0.938em 0;
      border-radius: 0.5em;
      border-left: 0.25em solid #8E2DE2;
    }
    .pronunciation-guide h3 {
      margin-bottom: 0.625em;
      color: #4A00E0;
    }
    .guide-item {
      display: flex;
      align-items: center;
      margin-bottom: 0.5em;
    }
    .word-example {
      font-weight: bold;
      min-width: 5em;
    }
    .phonetic {
      font-family: monospace;
      background: #e8e0f5;
      padding: 0.125em 0.375em;
      border-radius: 0.25em;
      margin: 0 0.625em;
    }
    .exercise-container {
      padding: 1.75em;
    }
    .word-bank {
      display: flex;
      flex-wrap: wrap;
      gap: 0.625em;
      margin: 1.25em 0;
      padding: 0.938em;
      background-color: #f8faff;
      border-radius: 0.625em;
      border: 1px solid #e0e6f1;
      justify-content: center;
    }
    .word-item {
      padding: 0.625em 1.125em;
      background: linear-gradient(90deg, #8E2DE2 0%, #4A00E0 100%);
      color: white;
      border-radius: 0.5em;
      cursor: grab;
      user-select: none;
      transition: transform 0.2s, box-shadow 0.2s;
      font-weight: 500;
      font-size: 1em;
      box-sizing: border-box;
      min-width: 3em;
      text-align: center;
    }
    .word-item:hover {
      transform: translateY(-0.125em);
      box-shadow: 0 0.25em 0.5em rgba(0, 0, 0, 0.15);
    }
    .word-item.dragging {
      opacity: 0.5;
    }
    .word-item.used {
      opacity: 0.5;
      background: linear-gradient(90deg, #cccccc 0%, #aaaaaa 100%);
      cursor: not-allowed;
    }
    .sentences {
      margin: 1.563em 0;
    }
    .sentence {
      margin-bottom: 1.25em;
      font-size: 1.125em;
      line-height: 1.6;
      padding: 0.625em;
      border-radius: 0.5em;
      transition: background-color 0.3s;
      box-sizing: border-box;
      word-break: break-word;
    }
    .sentence:hover {
      background-color: #f9f9f9;
    }
    .gap {
      padding: 0.25em 0.5em;
      border-bottom: 2px dashed #8E2DE2;
      background-color: rgba(142, 45, 226, 0.12);
      border-radius: 0.25em;
      transition: background-color 0.25s, border-color 0.25s;
      display: inline-block;
      min-width: 5em;
      height: 2.25em;
      vertical-align: middle;
      cursor: pointer;
      position: relative;
      font-size: 1em;
      box-sizing: border-box;
      text-align: center;
    }
    .gap.active {
      background-color: rgba(142, 45, 226, 0.2);
      border-bottom-color: #6a1fc7;
    }
    .gap.filled {
      background-color: transparent;
      border-bottom: none;
      color: #8E2DE2;
      font-weight: 600;
    }
    .gap.correct {
      color: #2ecc71;
    }
    .gap.incorrect {
      color: #e74c3c;
    }
    .progress-container {
      margin: 1.125em 0 1.25em;
    }
    .progress-bar {
      height: 0.75em;
      background-color: #f1f2f6;
      border-radius: 0.375em;
      overflow: hidden;
    }
    .progress {
      height: 100%;
      background: linear-gradient(90deg, #8E2DE2 0%, #4A00E0 100%);
      width: 0%;
      transition: width 0.5s ease;
    }
    .progress-text {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875em;
      color: #666;
      margin-top: 0.5em;
    }
    .message {
      padding: 0.875em;
      border-radius: 0.5em;
      margin-bottom: 0.938em;
      text-align: center;
      font-weight: 600;
      display: none;
      animation: fadeIn 0.5s;
      font-size: 1em;
    }
    .success {
      background-color: #e8f9f1;
      color: #1f9e56;
      border: 1px solid #b8eacb;
    }
    .error {
      background-color: #fdecea;
      color: #d6453d;
      border: 1px solid #f5b7b1;
    }
    .controls {
      display: flex;
      gap: 0.75em;
      margin-top: 1.25em;
      flex-wrap: wrap;
      justify-content: center;
    }
    .controls button {
      padding: 0.875em 1.25em;
      border: none;
      border-radius: 0.625em;
      cursor: pointer;
      font-weight: 700;
      transition: transform 0.15s, opacity 0.25s, background-color 0.25s;
      min-width: 10em;
      font-size: 1em;
      box-sizing: border-box;
    }
    .controls button:hover {
      transform: translateY(-0.125em);
      opacity: 0.95;
    }
    #check-btn {
      background: linear-gradient(90deg, #8E2DE2 0%, #4A00E0 100%);
      color: white;
    }
    #hint-btn {
      background-color: #f39c12;
      color: white;
    }
    #reset-btn {
      background-color: #e74c3c;
      color: white;
    }
    #solution-btn {
      background-color: #2ecc71;
      color: white;
    }
    footer {
      text-align: center;
      padding: 1em;
      color: #888;
      font-size: 0.875em;
      border-top: 1px solid #f1f2f6;
    }
    /* Responsive for scaling in embedded mode */
    @media (max-width: 900px) {
      .container {
        max-width: 99vw;
        font-size: 0.98em;
      }
      .exercise-container {
        padding: 0.9em;
      }
    }
    @media (max-width: 640px) {
      html {
        font-size: 14px;
      }
      h1 {
        font-size: 1.3em;
      }
      .sentence {
        font-size: 1em;
      }
      .controls {
        flex-direction: column;
      }
      .controls button {
        width: 100%;
      }
      .word-item {
        padding: 0.5em 0.75em;
        font-size: 0.96em;
      }
      .gap {
        min-width: 3.5em;
        height: 1.7em;
        font-size: 0.98em;
      }
    }
    @media (max-width: 420px) {
      html {
        font-size: 12px;
      }
      .container {
        min-width: unset;
        padding: 0;
      }
      .exercise-container,
      .instructions,
      .pronunciation-guide {
        padding-left: 0.3em;
        padding-right: 0.3em;
      }
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(0.625em);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    /* Focus styles for accessibility */
    :focus-visible {
      outline: 3px solid rgba(142, 45, 226, 0.55);
      outline-offset: 2px;
      border-radius: 0.5em;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Grammar Exercise: Life vs. Live</h1>
      <p>Pronunciation Differences Practice</p>
    </header>

    <div class="instructions">
      <p>Complete the sentences. Drag and drop the correct words from the word bank.</p>
    </div>

    <div class="pronunciation-guide">
      <h3>Pronunciation Guide:</h3>
      <div class="guide-item">
        <span class="word-example">life</span>
        <span class="phonetic">/laɪf/</span>
        <span>(noun) existence of an individual</span>
      </div>
      <div class="guide-item">
        <span class="word-example">live</span>
        <span class="phonetic">/lɪv/</span>
        <span>(verb) to be alive, reside</span>
      </div>
      <div class="guide-item">
        <span class="word-example">live</span>
        <span class="phonetic">/laɪv/</span>
        <span>(adjective) not recorded, happening now</span>
      </div>
      <div class="guide-item">
        <span class="word-example">lives</span>
        <span class="phonetic">/laɪvz/</span>
        <span>(noun, plural) multiple existences</span>
      </div>
      <div class="guide-item">
        <span class="word-example">lives</span>
        <span class="phonetic">/lɪvz/</span>
        <span>(verb) 3rd person singular of live</span>
      </div>
    </div>

    <div class="exercise-container">
      <div class="word-bank" id="word-bank">
        <!-- Words will be populated by JavaScript in random order -->
      </div>

      <div class="sentences">
        <div class="sentence">1. Quality of <span class="gap" data-correct="life" data-id="1"></span> has improved in many countries.</div>
        <div class="sentence">2. I <span class="gap" data-correct="live" data-id="2"></span> in a small apartment in the city center.</div>
        <div class="sentence">3. Cats have nine <span class="gap" data-correct="lives" data-id="3"></span>, or so they say.</div>
        <div class="sentence">4. We watched the <span class="gap" data-correct="live" data-id="4"></span> broadcast of the concert.</div>
        <div class="sentence">5. She <span class="gap" data-correct="lives" data-id="5"></span> with her parents while studying at university.</div>
        <div class="sentence">6. The meaning of <span class="gap" data-correct="life" data-id="6"></span> is a profound philosophical question.</div>
        <div class="sentence">7. Many people <span class="gap" data-correct="live" data-id="7"></span> longer now than in previous centuries.</div>
        <div class="sentence">8. The <span class="gap" data-correct="live" data-id="8"></span> audience cheered when the band started playing.</div>
        <div class="sentence">9. He risked their <span class="gap" data-correct="lives" data-id="9"></span> to save the drowning child.</div>
        <div class="sentence">10. My brother <span class="gap" data-correct="lives" data-id="10"></span> in Australia now, but he visits every year.</div>
      </div>

      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress" id="progress-bar"></div>
        </div>
        <div class="progress-text">
          <span>Progress</span>
          <span id="progress-text">0%</span>
        </div>
      </div>

      <div class="message success" id="success-message">
        Congratulations! All answers are correct.
      </div>

      <div class="message error" id="error-message">
        Some answers are incorrect. Please try again.
      </div>

      <div class="controls">
        <button id="check-btn">Check answers</button>
        <button id="hint-btn">Hint</button>
        <button id="reset-btn">Reset</button>
        <button id="solution-btn">Show Solution</button>
      </div>
    </div>

    <footer>
      <p>Educasa.pe, 2025</p>
    </footer>
  </div>

  <script>
    // Scale content for embedding (iframe/parent page), supporting zoom and resizing
    function applyEmbedScaling() {
      // If this page is inside an iframe, allow parent to set scale, or auto-fit if needed
      function getScale() {
        try {
          if (window !== window.parent) {
            // Optionally, listen to parent messages for scaling instructions
            window.addEventListener('message', function(e) {
              if (e.data && e.data.type === 'set-embed-scale') {
                document.body.style.zoom = e.data.value;
              }
            });
            // Or, auto-scale if container is smaller than content
            const container = document.querySelector('.container');
            if (container) {
              // Check available width (viewport) vs max content width
              const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
              const scale = Math.min(1, vw / 920); // slightly above max-width
              if (scale < 1) {
                document.body.style.zoom = scale;
                // For Safari/iOS compatibility, fallback to transform+origin
                document.body.style.transform = `scale(${scale})`;
                document.body.style.transformOrigin = 'top left';
                document.body.style.width = (100/scale) + 'vw';
              }
            }
          }
        } catch (e) {}
      }
      getScale();
      window.addEventListener('resize', getScale);
    }
    applyEmbedScaling();

    document.addEventListener('DOMContentLoaded', function() {
      // Define the words for the exercise
      const words = [
        "life",
        "live",
        "lives",
        "lives",
        "live",
        "life",
        "live",
        "live",
        "lives",
        "lives"
      ];
      
      // Shuffle the words array to randomize order
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }
      
      // Initialize word bank with shuffled words
      const wordBank = document.getElementById('word-bank');
      const shuffledWords = shuffleArray([...words]);
      
      shuffledWords.forEach(word => {
        const wordItem = document.createElement('div');
        wordItem.className = 'word-item';
        wordItem.setAttribute('draggable', 'true');
        wordItem.dataset.word = word;
        wordItem.textContent = word;
        wordBank.appendChild(wordItem);
      });
      
      // Get DOM elements
      const gaps = document.querySelectorAll('.gap');
      const wordItems = document.querySelectorAll('.word-item');
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');
      const successMessage = document.getElementById('success-message');
      const errorMessage = document.getElementById('error-message');
      const checkBtn = document.getElementById('check-btn');
      const hintBtn = document.getElementById('hint-btn');
      const resetBtn = document.getElementById('reset-btn');
      const solutionBtn = document.getElementById('solution-btn');
      
      let filledGaps = 0;
      const totalGaps = gaps.length;
      let hasCheckedAnswers = false;
      
      // Initialize progress
      updateProgress();
      
      // Initialize drag and drop functionality
      function initDragAndDrop() {
        // Add event listeners to word items for drag start
        wordItems.forEach(word => {
          word.addEventListener('dragstart', handleDragStart);
          word.addEventListener('dragend', handleDragEnd);
        });
        
        // Add event listeners to gaps for drag events
        gaps.forEach(gap => {
          gap.addEventListener('dragover', handleDragOver);
          gap.addEventListener('dragenter', handleDragEnter);
          gap.addEventListener('dragleave', handleDragLeave);
          gap.addEventListener('drop', handleDrop);
          gap.addEventListener('click', handleGapClick);
        });
      }
      
      // Handle drag start
      function handleDragStart(e) {
        this.classList.add('dragging');
        e.dataTransfer.setData('text/plain', this.dataset.word);
      }
      
      // Handle drag end
      function handleDragEnd() {
        this.classList.remove('dragging');
      }
      
      // Handle gap click - to free a completed gap
      function handleGapClick(e) {
        // Only allow freeing gaps if they're filled
        if (this.classList.contains('filled')) {
          freeGap(this);
        }
      }
      
      // Free a gap (remove the answer)
      function freeGap(gap) {
        const word = gap.textContent;
        gap.textContent = '';
        gap.classList.remove('filled', 'correct', 'incorrect');
        
        // Make the word available again in the word bank
        wordItems.forEach(wordItem => {
          if (wordItem.dataset.word === word) {
            wordItem.classList.remove('used');
          }
        });
        
        filledGaps--;
        updateProgress();
        
        // Hide messages when user makes changes
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
        hasCheckedAnswers = false;
      }
      
      // Handle drag over
      function handleDragOver(e) {
        e.preventDefault();
      }
      
      // Handle drag enter
      function handleDragEnter(e) {
        e.preventDefault();
        this.classList.add('active');
      }
      
      // Handle drag leave
      function handleDragLeave() {
        this.classList.remove('active');
      }
      
      // Handle drop
      function handleDrop(e) {
        e.preventDefault();
        this.classList.remove('active');
        
        const word = e.dataTransfer.getData('text/plain');
        
        // If this gap is already filled, free it first
        if (this.classList.contains('filled')) {
          freeGap(this);
        }
        
        fillGap(this, word);
      }
      
      // Fill gap with word
      function fillGap(gap, word) {
        // Fill the gap
        gap.textContent = word;
        gap.classList.add('filled');
        filledGaps++;
        
        // Mark word as used in the word bank
        wordItems.forEach(wordItem => {
          if (wordItem.dataset.word === word) {
            wordItem.classList.add('used');
          }
        });
        
        // Update progress
        updateProgress();
        
        // If we've previously checked answers, reset the visual state for new answers
        if (hasCheckedAnswers) {
          gap.classList.remove('correct', 'incorrect');
        }
        
        // Hide messages when user makes changes
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
        hasCheckedAnswers = false;
        
        // Check if all gaps are filled
        if (filledGaps === totalGaps) {
          // Auto-check if all gaps are filled
          checkAnswers();
        }
      }
      
      // Update progress bar and text
      function updateProgress() {
        const progress = (filledGaps / totalGaps) * 100;
        progressBar.style.width = `${progress}%`;
        progressText.textContent = `${Math.round(progress)}%`;
      }
      
      // Check answers
      function checkAnswers() {
        let allCorrect = true;
        
        gaps.forEach(gap => {
          const userAnswer = gap.textContent.trim().toLowerCase();
          const correctAnswer = gap.dataset.correct.toLowerCase();
          
          if (userAnswer !== correctAnswer) {
            gap.classList.add('incorrect');
            gap.classList.remove('correct');
            allCorrect = false;
          } else {
            gap.classList.add('correct');
            gap.classList.remove('incorrect');
          }
        });
        
        if (allCorrect) {
          successMessage.style.display = 'block';
          errorMessage.style.display = 'none';
        } else {
          successMessage.style.display = 'none';
          errorMessage.style.display = 'block';
        }
        
        hasCheckedAnswers = true;
      }
      
      // Handle check button click
      checkBtn.addEventListener('click', checkAnswers);
      
      // Handle hint button click
      hintBtn.addEventListener('click', function() {
        // Find first unfilled gap or incorrect answer
        let gapToHint = null;
        
        for (const gap of gaps) {
          if (!gap.classList.contains('filled')) {
            gapToHint = gap;
            break;
          } else if (gap.textContent.trim().toLowerCase() !== gap.dataset.correct.toLowerCase()) {
            gapToHint = gap;
            break;
          }
        }
        
        if (gapToHint) {
          // Highlight the gap
          gapToHint.classList.add('active');
          
          // Show first letter as hint
          const correctAnswer = gapToHint.dataset.correct;
          alert(`Hint: The correct word is "${correctAnswer}".`);
          
          // Remove highlight after a delay
          setTimeout(() => {
            gapToHint.classList.remove('active');
          }, 2000);
        } else {
          alert('All gaps are correctly filled!');
        }
      });
      
      // Handle reset button click
      resetBtn.addEventListener('click', function() {
        gaps.forEach(gap => {
          const word = gap.textContent;
          gap.textContent = '';
          gap.classList.remove('filled', 'correct', 'incorrect');
          
          // Make the word available again in the word bank
          wordItems.forEach(wordItem => {
            if (wordItem.dataset.word === word) {
              wordItem.classList.remove('used');
            }
          });
        });
        
        filledGaps = 0;
        updateProgress();
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
        hasCheckedAnswers = false;
      });
      
      // Handle solution button click
      solutionBtn.addEventListener('click', function() {
        gaps.forEach(gap => {
          gap.textContent = gap.dataset.correct;
          gap.classList.add('filled', 'correct');
          gap.classList.remove('incorrect');
          
          // Mark words as used in the word bank
          wordItems.forEach(wordItem => {
            if (wordItem.dataset.word === gap.dataset.correct) {
              wordItem.classList.add('used');
            }
          });
        });
        
        filledGaps = totalGaps;
        updateProgress();
        checkAnswers();
      });

      
      // Initialize the exercise
      initDragAndDrop();
    });
  </script>
</body>
</html>
