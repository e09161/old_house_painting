<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Reservation Dialog Ordering</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 25px;
            margin: 10px 0;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .subtitle {
            color: #5d6d7e;
            font-size: 1.1rem;
        }
        
        .instructions {
            background-color: #e8f4fc;
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 25px;
            font-size: 1rem;
            line-height: 1.5;
            color: #2c3e50;
            border-left: 5px solid #3498db;
        }
        
        .instructions p {
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .instructions ul {
            margin-left: 20px;
            margin-bottom: 0;
        }
        
        .instructions li {
            margin-bottom: 8px;
            padding-left: 5px;
        }
        
        .dialog-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        /* Custom scrollbar */
        .dialog-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .dialog-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }
        
        .dialog-container::-webkit-scrollbar-thumb {
            background: #3498db;
            border-radius: 8px;
        }
        
        .dialog-container::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        .dialog-line {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e1e4e8;
            cursor: move;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .dialog-line:hover {
            background-color: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .dialog-line.dragging {
            opacity: 0.5;
            background-color: #d0ebff;
        }
        
        /* EXACT COPY OF WORKING BUTTON STYLING */
        .audio-btn {
            width: 40px;
            height: 40px;
            background-color: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
            font-size: 1.2rem;
            border: none;
            margin-right: 15px;
            -webkit-touch-callout: none;
        }
        
        .audio-btn:hover, .audio-btn:active {
            background-color: #2980b9;
            transform: scale(1.1);
        }
        
        .audio-btn.playing {
            background-color: #e74c3c;
        }
        
        .dialog-text {
            flex: 1;
            font-size: 16px;
            line-height: 1.4;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 15px;
        }
        
        button {
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        #check-btn {
            background: linear-gradient(to right, #2ecc71, #1abc9c);
        }
        
        #check-btn:hover {
            background: linear-gradient(to right, #27ae60, #16a085);
        }
        
        #reset-btn {
            background: linear-gradient(to right, #e74c3c, #e67e22);
        }
        
        #reset-btn:hover {
            background: linear-gradient(to right, #c0392b, #d35400);
        }
        
        .feedback {
            margin-top: 20px;
            padding: 16px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            display: none;
        }
        
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        
        .hint {
            font-size: 14px;
            color: #6c757d;
            margin-top: 8px;
            text-align: center;
            font-style: italic;
        }
        
        @media (max-width: 600px) {
            .dialog-text {
                font-size: 15px;
            }
            
            .audio-btn {
                width: 38px;
                height: 38px;
                margin-right: 12px;
                font-size: 1.1rem;
            }
            
            button {
                padding: 12px 18px;
                font-size: 15px;
                min-width: 130px;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .instructions {
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            .instructions {
                padding: 12px;
                font-size: 0.95rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .audio-btn {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
        }
        
        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            .dialog-line:hover {
                transform: none;
            }
            
            .audio-btn:hover {
                background-color: #3498db;
                transform: none;
            }
            
            .audio-btn:active {
                background-color: #2980b9;
                transform: scale(1.1);
            }
            
            button:hover {
                transform: none;
            }
            
            button:active {
                transform: scale(0.98);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Restaurant Reservation Dialog</h1>
            <p class="subtitle">Put the conversation in the correct order</p>
        </header>
        
        <div class="instructions">
            <p>Instructions:</p>
            <ul>
                <li>Drag and drop the lines to arrange them in the correct order</li>
                <li>Click the play button to listen to each line</li>
                <li>When finished, click "Check Order" to verify your answer</li>
                <li>Use "Reset" to start over</li>
            </ul>
        </div>
        
        <div class="dialog-container" id="dialogContainer">
            <!-- Dialog lines will be inserted here by JavaScript -->
        </div>
        
        <div class="controls">
            <button id="check-btn">Check Order</button>
            <button id="reset-btn">Reset</button>
        </div>
        
        <div class="feedback" id="feedback"></div>
        <div class="hint" id="hint">Hint: The conversation starts with the receptionist answering the phone</div>
    </div>

    <script>
        // Dialog data - each line with text and audio file name
        const dialogLines = [
            { text: "Luigi's. Can I help you?", audio: "S1.mp3" },
            { text: "Yes, I'd like to make a reservation, please.", audio: "S2.mp3" },
            { text: "Of course. What day?", audio: "S3.mp3" },
            { text: "Friday, August 15.", audio: "S4.mp3" },
            { text: "Is that for lunch or dinner?", audio: "S5.mp3" },
            { text: "Dinner.", audio: "S6.mp3" },
            { text: "I'm sorry. We have tables for lunch, but there aren't any tables for dinner on the 15th. There's a big party that night.", audio: "S7.mp3" },
            { text: "Oh. It's my birthday.", audio: "S8.mp3" },
            { text: "Would you like a different day?", audio: "S9.mp3" },
            { text: "What about Saturday – Saturday, August 16th?", audio: "S10.mp3" },
            { text: "For dinner?", audio: "S11.mp3" },
            { text: "Yes.", audio: "S12.mp3" },
            { text: "Yes. We have some tables for dinner on Saturday.", audio: "S13.mp3" },
            { text: "Great.", audio: "S14.mp3" },
            { text: "How many people?", audio: "S15.mp3" },
            { text: "Six. Do you have a window table?", audio: "S16.mp3" },
            { text: "Excuse me?", audio: "S17.mp3" },
            { text: "Do you have a table near the window with a view of the park?", audio: "S18.mp3" },
            { text: "Certainly. What time would you like, seven thirty or nine o'clock?", audio: "S19.mp3" },
            { text: "Er, nine, I think.", audio: "S20.mp3" },
            { text: "And what's your name?", audio: "S21.mp3" },
            { text: "Lara Gluck.", audio: "S22.mp3" },
            { text: "Can you spell that, please?", audio: "S23.mp3" },
            { text: "L-A-R-A G-L-U-C-K.", audio: "S24.mp3" },
            { text: "OK. That's a window table for six people at 9:00 p.m. on Saturday, August 16th.", audio: "S25.mp3" },
            { text: "Thanks. Is there a dress code?", audio: "S26.mp3" },
            { text: "Yes. No jeans, and we ask men to wear a jacket.", audio: "S27.mp3" },
            { text: "OK. Oh, and can I pay by credit card?", audio: "S28.mp3" },
            { text: "Yes, that's no problem. See you Saturday.", audio: "S29.mp3" }
        ];

        // Store audio elements
        const audioElements = {};
        let currentlyPlaying = null;

        // Shuffle the dialog lines for the exercise
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Initialize the exercise
        function initializeExercise() {
            const dialogContainer = document.getElementById('dialogContainer');
            dialogContainer.innerHTML = '';
            
            const shuffledLines = shuffleArray(dialogLines);
            
            shuffledLines.forEach((line, index) => {
                const dialogLine = document.createElement('div');
                dialogLine.className = 'dialog-line';
                dialogLine.draggable = true;
                dialogLine.dataset.index = index;
                dialogLine.dataset.originalIndex = dialogLines.indexOf(line);
                
                const audioBtn = document.createElement('button');
                audioBtn.className = 'audio-btn';
                audioBtn.innerHTML = '▶';
                audioBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    playAudio(line.audio, audioBtn);
                });
                
                const dialogText = document.createElement('div');
                dialogText.className = 'dialog-text';
                dialogText.textContent = line.text;
                
                dialogLine.appendChild(audioBtn);
                dialogLine.appendChild(dialogText);
                dialogContainer.appendChild(dialogLine);
            });
            
            // Add drag and drop event listeners
            setupDragAndDrop();
            
            // Reset feedback
            document.getElementById('feedback').style.display = 'none';
        }

        // Set up drag and drop functionality
        function setupDragAndDrop() {
            const dialogLines = document.querySelectorAll('.dialog-line');
            let draggedItem = null;
            
            dialogLines.forEach(line => {
                line.addEventListener('dragstart', function() {
                    draggedItem = this;
                    setTimeout(() => this.classList.add('dragging'), 0);
                });
                
                line.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    draggedItem = null;
                });
                
                line.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                line.addEventListener('dragenter', function(e) {
                    e.preventDefault();
                    this.classList.add('dragging-over');
                });
                
                line.addEventListener('dragleave', function() {
                    this.classList.remove('dragging-over');
                });
                
                line.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragging-over');
                    
                    if (draggedItem && this !== draggedItem) {
                        const dialogContainer = document.getElementById('dialogContainer');
                        const allLines = Array.from(dialogContainer.querySelectorAll('.dialog-line'));
                        const draggedIndex = allLines.indexOf(draggedItem);
                        const targetIndex = allLines.indexOf(this);
                        
                        if (draggedIndex < targetIndex) {
                            dialogContainer.insertBefore(draggedItem, this.nextSibling);
                        } else {
                            dialogContainer.insertBefore(draggedItem, this);
                        }
                    }
                });
            });
        }

        // Audio playback function
        function playAudio(audioFile, button) {
            // Stop currently playing audio if any
            if (currentlyPlaying) {
                currentlyPlaying.pause();
                currentlyPlaying.currentTime = 0;
                // Reset all play buttons
                document.querySelectorAll('.audio-btn').forEach(btn => {
                    btn.innerHTML = '▶';
                    btn.classList.remove('playing');
                });
            }
            
            // Create audio element if it doesn't exist
            if (!audioElements[audioFile]) {
                audioElements[audioFile] = new Audio(audioFile);
                
                audioElements[audioFile].addEventListener('ended', function() {
                    button.innerHTML = '▶';
                    button.classList.remove('playing');
                    currentlyPlaying = null;
                });
                
                audioElements[audioFile].addEventListener('error', function() {
                    console.error(`Error loading audio file: ${audioFile}`);
                    button.innerHTML = '▶';
                    button.classList.remove('playing');
                    currentlyPlaying = null;
                    alert(`Error loading audio file: ${audioFile}. Please check if the file exists.`);
                });
            }
            
            // Play the audio
            audioElements[audioFile].play().then(() => {
                button.innerHTML = '⏸';
                button.classList.add('playing');
                currentlyPlaying = audioElements[audioFile];
            }).catch(error => {
                console.error(`Error playing audio: ${error}`);
                button.innerHTML = '▶';
                button.classList.remove('playing');
            });
        }

        // Check if the order is correct
        function checkOrder() {
            const dialogContainer = document.getElementById('dialogContainer');
            const currentOrder = Array.from(dialogContainer.querySelectorAll('.dialog-line'))
                .map(line => parseInt(line.dataset.originalIndex));
            
            const correctOrder = Array.from({length: dialogLines.length}, (_, i) => i);
            
            const isCorrect = JSON.stringify(currentOrder) === JSON.stringify(correctOrder);
            const feedback = document.getElementById('feedback');
            
            if (isCorrect) {
                feedback.textContent = "Correct! You've arranged the conversation in the right order.";
                feedback.className = 'feedback correct';
            } else {
                feedback.textContent = "Not quite right. Try again or listen to the audio for clues.";
                feedback.className = 'feedback incorrect';
            }
            
            feedback.style.display = 'block';
        }

        // Event listeners for buttons
        document.getElementById('check-btn').addEventListener('click', checkOrder);
        document.getElementById('reset-btn').addEventListener('click', function() {
            // Stop any currently playing audio
            if (currentlyPlaying) {
                currentlyPlaying.pause();
                currentlyPlaying.currentTime = 0;
                document.querySelectorAll('.audio-btn').forEach(btn => {
                    btn.innerHTML = '▶';
                    btn.classList.remove('playing');
                });
                currentlyPlaying = null;
            }
            initializeExercise();
        });

        // Initialize the exercise when the page loads
        window.addEventListener('DOMContentLoaded', initializeExercise);
    </script>
</body>
</html>
